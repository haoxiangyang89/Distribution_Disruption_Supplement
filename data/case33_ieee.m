function mpc = case33bw
%CASE33BW  Power flow data for 33 bus distribution system from Baran & Wu
%    Please see CASEFORMAT for details on the case file format.
%
%    Data from ...
%       M. E. Baran and F. F. Wu, "Network reconfiguration in distribution
%       systems for loss reduction and load balancing," in IEEE Transactions
%       on Power Delivery, vol. 4, no. 2, pp. 1401-1407, Apr 1989.
%       doi: 10.1109/61.25627
%       URL: http://doi.org/10.1109/61.25627

%% MATPOWER Case Format : Version 2
mpc.version = '2';

%%-----  Power Flow Data  -----%%
%% system MVA base
mpc.baseMVA = 1;

%% bus data
%	bus_i	type	Pd	Qd	Gs	Bs	area	Vm	Va	baseKV	zone	Vmax	Vmin
mpc.bus = [
	1	3	0	0	0	0	1	1	0	12.66	1	1	1;
	2	1	100	60	0	0	1	1	0	12.66	1	1.1	0.9;
	3	1	90	40	0	0	1	1	0	12.66	1	1.1	0.9;
	4	1	120	80	0	0	1	1	0	12.66	1	1.1	0.9;
	5	1	60	30	0	0	1	1	0	12.66	1	1.1	0.9;
	6	1	60	20	0	0	1	1	0	12.66	1	1.1	0.9;
	7	1	200	100	0	0	1	1	0	12.66	1	1.1	0.9;
	8	1	200	100	0	0	1	1	0	12.66	1	1.1	0.9;
	9	1	60	20	0	0	1	1	0	12.66	1	1.1	0.9;
	10	1	60	20	0	0	1	1	0	12.66	1	1.1	0.9;
	11	1	45	30	0	0	1	1	0	12.66	1	1.1	0.9;
	12	1	60	35	0	0	1	1	0	12.66	1	1.1	0.9;
	13	1	60	35	0	0	1	1	0	12.66	1	1.1	0.9;
	14	1	120	80	0	0	1	1	0	12.66	1	1.1	0.9;
	15	1	60	10	0	0	1	1	0	12.66	1	1.1	0.9;
	16	1	60	20	0	0	1	1	0	12.66	1	1.1	0.9;
	17	1	60	20	0	0	1	1	0	12.66	1	1.1	0.9;
	18	1	90	40	0	0	1	1	0	12.66	1	1.1	0.9;
	19	1	90	40	0	0	1	1	0	12.66	1	1.1	0.9;
	20	1	90	40	0	0	1	1	0	12.66	1	1.1	0.9;
	21	1	90	40	0	0	1	1	0	12.66	1	1.1	0.9;
	22	1	90	40	0	0	1	1	0	12.66	1	1.1	0.9;
	23	1	90	50	0	0	1	1	0	12.66	1	1.1	0.9;
	24	1	420	200	0	0	1	1	0	12.66	1	1.1	0.9;
	25	1	420	200	0	0	1	1	0	12.66	1	1.1	0.9;
	26	1	60	25	0	0	1	1	0	12.66	1	1.1	0.9;
	27	1	60	25	0	0	1	1	0	12.66	1	1.1	0.9;
	28	1	60	20	0	0	1	1	0	12.66	1	1.1	0.9;
	29	1	120	70	0	0	1	1	0	12.66	1	1.1	0.9;
	30	1	200	600	0	0	1	1	0	12.66	1	1.1	0.9;
	31	1	150	70	0	0	1	1	0	12.66	1	1.1	0.9;
	32	1	210	100	0	0	1	1	0	12.66	1	1.1	0.9;
	33	1	60	40	0	0	1	1	0	12.66	1	1.1	0.9;
];

%% generator data
%	bus	Pg	Qg	Qmax	Qmin	Vg	mBase	status	Pmax	Pmin	Pc1	Pc2	Qc1min	Qc1max	Qc2min	Qc2max	ramp_agc	ramp_10	ramp_30	ramp_q	apf
mpc.gen = [
	1	 0.0	 0.0	 2	 -2	 1.06	 100.0	 1	 4.000	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 2.0	 0.0	 0.0	 0.0	 0.0;
	3	 0.0	 0.0	 0.250	 -0.250	 1.04017	 100.0	 1	 0.275	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.15	 0.0	 0.0	 0.0	 0.0;
	6	 0.0	 0.0	 0.250	 -0.250	 1.00788	 100.0	 1	 0.300	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.15	 0.0	 0.0	 0.0	 0.0;
	18	 0.0	 0.0	 1	 -1	 1.06	 100.0	 1	 1.200	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.5	 0.0	 0.0	 0.0	 0.0;
	19	 0.0	 0.0	 0.250	 -0.250	 1.06	 100.0	 1	 0.225	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.1	 0.0	 0.0	 0.0	 0.0;
	23	 0.0	 0.0	 0.250	 -0.250	 1.06	 100.0	 1	 0.275	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.15	 0.0	 0.0	 0.0	 0.0;
	26	 0.0	 0.0	 0.250	 -0.250	 1.06	 100.0	 1	 0.250	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.1	 0.0	 0.0	 0.0	 0.0;
	33	 0.0	 0.0	 1	 -1	 1.06	 100.0	 1	 1.225	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.5	 0.0	 0.0	 0.0	 0.0;
];

%% generator cost data
%	2	startup	shutdown	n	c(n-1)	...	c0
mpc.gencost = [
	2	 0.0	 0.0	 3	   1.0000	   2.000000	   0.50000;
	2	 0.0	 0.0	 3	   20.0000	   10.00000	   4.00000;
	2	 0.0	 0.0	 3	   30.0000	   15.00000	   8.00000;
	2	 0.0	 0.0	 3	   5.0000	   10.00000	   10.0000;
	2	 0.0	 0.0	 3	   40.0000	   20.00000	   5.00000;
	2	 0.0	 0.0	 3	   20.0000	   10.00000	   4.00000;
	2	 0.0	 0.0	 3	   30.0000	   15.000000	   2.00000;
	2	 0.0	 0.0	 3	   5.0000	   10.00000	   4.00000;
];

%% branch data
%	fbus	tbus	r	x	b	rateA	rateB	rateC	ratio	angle	status	angmin	angmax
mpc.branch = [
	1	2	0.00057525912	0.00029324489	0	6.6144	6.6144	6.6144	0	0	1	-30	30;
	2	3	0.00307595167	0.0015666764	0	6.6144	6.6144	6.6144	0	0	1	-30	30;
	3	4	0.00228356656	0.00116299674	0	6.6144	6.6144	6.6144	0	0	1	-30	30;
	4	5	0.00237777928	0.00121103899	0	6.6144	6.6144	6.6144	0	0	1	-30	30;
	5	6	0.00510994811	0.00441115179	0	6.6144	6.6144	6.6144	0	0	1	-30	30;
	6	7	0.00116798814	0.00386084969	0	6.6144	6.6144	6.6144	0	0	1	-30	30;
	7	8	0.0044386045	0.00146684835	0	6.6144	6.6144	6.6144	0	0	1	-30	30;
	8	9	0.00642643047	0.00461704714	0	0.9568	0.9568	0.9568	0	0	1	-30	30;
	9	10	0.00651378001	0.00461704714	0	0.9568	0.9568	0.9568	0	0	1	-30	30;
	10	11	0.00122663712	0.00040555144	0	0.9568	0.9568	0.9568	0	0	1	-30	30;
	11	12	0.00233597628	0.00077241951	0	0.9568	0.9568	0.9568	0	0	1	-30	30;
	12	13	0.00915922324	0.00720633708	0	0.9568	0.9568	0.9568	0	0	1	-30	30;
	13	14	0.00337917936	0.00444796338	0	0.9568	0.9568	0.9568	0	0	1	-30	30;
	14	15	0.00368739846	0.00328184702	0	0.9568	0.9568	0.9568	0	0	1	-30	30;
	15	16	0.00465635443	0.00340039282	0	0.9568	0.9568	0.9568	0	0	1	-30	30;
	16	17	0.00804239697	0.01073775422	0	0.9568	0.9568	0.9568	0	0	1	-30	30;
	17	18	0.00456713311	0.00358133116	0	0.9568	0.9568	0.9568	0	0	1	-30	30;
	2	19	0.00102323747	0.00097644308	0	6.6144	6.6144	6.6144	0	0	1	-30	30;
	19	20	0.00938508419	0.00845668336	0	0.9568	0.9568	0.9568	0	0	1	-30	30;
	20	21	0.00255497406	0.00298485858	0	0.9568	0.9568	0.9568	0	0	1	-30	30;
	21	22	0.00442300637	0.00584805173	0	0.9568	0.9568	0.9568	0	0	1	-30	30;
	3	23	0.0028151509	0.00192356167	0	6.6144	6.6144	6.6144	0	0	1	-30	30;
	23	24	0.00560284909	0.00442425422	0	6.6144	6.6144	6.6144	0	0	1	-30	30;
	24	25	0.00559037059	0.0043743402	0	0.9568	0.9568	0.9568	0	0	1	-30	30;
	6	26	0.00126656834	0.00064513875	0	6.6144	6.6144	6.6144	0	0	1	-30	30;
	26	27	0.00177319567	0.00090281989	0	0.9568	0.9568	0.9568	0	0	1	-30	30;
	27	28	0.00660736881	0.00582559042	0	0.9568	0.9568	0.9568	0	0	1	-30	30;
	28	29	0.00501760717	0.00437122057	0	0.9568	0.9568	0.9568	0	0	1	-30	30;
	29	30	0.00316642084	0.00161284687	0	0.9568	0.9568	0.9568	0	0	1	-30	30;
	30	31	0.00607952801	0.00600840053	0	0.9568	0.9568	0.9568	0	0	1	-30	30;
	31	32	0.00193728802	0.00225798562	0	0.9568	0.9568	0.9568	0	0	1	-30	30;
	32	33	0.00212758523	0.00330805188	0	0.9568	0.9568	0.9568	0	0	1	-30	30;
];

%% convert branch impedances from Ohms to p.u.
% [PQ, PV, REF, NONE, BUS_I, BUS_TYPE, PD, QD, GS, BS, BUS_AREA, VM, ...
%     VA, BASE_KV, ZONE, VMAX, VMIN, LAM_P, LAM_Q, MU_VMAX, MU_VMIN] = idx_bus;
% [F_BUS, T_BUS, BR_R, BR_X, BR_B, RATE_A, RATE_B, RATE_C, ...
%     TAP, SHIFT, BR_STATUS, PF, QF, PT, QT, MU_SF, MU_ST, ...
%     ANGMIN, ANGMAX, MU_ANGMIN, MU_ANGMAX] = idx_brch;
% Vbase = mpc.bus(1, BASE_KV) * 1e3;      %% in Volts
% Sbase = mpc.baseMVA * 1e6;              %% in VA
% mpc.branch(:, [BR_R BR_X]) = mpc.branch(:, [BR_R BR_X]) / (Vbase^2 / Sbase);
%
%% convert loads from kW to MW
% mpc.bus(:, [PD, QD]) = mpc.bus(:, [PD, QD]) / 1e3;
